<?php

namespace DummyNamespace;

use Artibet\Laralib\Abstracts\ExportBase;
use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet;

class DummyClass extends ExportBase
{
  private iterable $records;

  // ---------------------------------------------------------------------------------------
  // Constructor - set records
  // ---------------------------------------------------------------------------------------
  public function __construct(iterable $records)
  {
    $this->records = $records;
  }

  // ---------------------------------------------------------------------------------------
  // Override: templatePath()
  // ---------------------------------------------------------------------------------------
  protected function templatePath(): string
  {
    return storage_path('app/private/templates/export_template.xlsx');
  }

  // ---------------------------------------------------------------------------------------
  // Override: filename
  // ---------------------------------------------------------------------------------------
  protected function filename(): string
  {
    return "export.xlsx";
  }

  // ---------------------------------------------------------------------------------------
  // Override: build($sheet)
  // ---------------------------------------------------------------------------------------
  protected function build(Worksheet $sheet): void
  {
    $row = 2;
    foreach ($this->records as $record) {
      $sheet->setCellValue("A{$row}", $row - 1);
      // ...
      $row += 1;
    }
  }
}
